<!DOCTYPE html>

<html lang="zh-Hant">
<head>
<link href="styles.css" rel="stylesheet"/>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>è‡ªç„¶å¤§å” âˆ£ è¨‚å–®æ’ç¨‹ç³»çµ±</title>
<link href="https://res.cloudinary.com/dijzndzw2/image/upload/v1757176751/logo-3_hddq08.png" rel="icon" type="image/png"/>
<script defer="True" src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
<header>
<div class="wrap toolbar">
<div class="pill">
<strong>æœˆä»½</strong>
<select id="yearSel"><option value="è‡ªç„¶å¤§å”"></option></select>
<select id="monthSel"></select>
</div>
<div class="pill">
<strong>ä½œæ¥­äººå“¡</strong>
<select id="staffFilter"></select>
</div>
<div class="pill">
<strong>ç‹€æ³</strong>
<select id="statusFilter">
<option value="">å…¨éƒ¨</option>
<option value="æ’å®š">æ’å®š</option>
<option value="å®Œæˆ">å®Œæˆ</option>
<option value="æœªå®Œæˆ">æœªå®Œæˆ</option>
</select>
</div>
<div class="pill">
<strong>å®Œæˆæ™‚é–“</strong>
<select id="completedRange">
<option value="">å…¨éƒ¨</option>
<option value="7">è¿‘7å¤©</option>
<option value="30">è¿‘30å¤©</option>
</select>
</div>
<label class="pill" style="gap:8px">
<input checked="" id="showUndated" type="checkbox"/>
<span>é¡¯ç¤ºæœªæ’æœŸ</span>
</label>
<div class="pill">
<strong>æœå°‹</strong>
<input id="searchInput" placeholder="å§“å / é›»è©± / åœ°å€" style="width:220px" type="text"/>
</div>
<div class="right"><button class="accent" id="gdriveBackupBtn" onclick="initGoogleBackup()">â˜ï¸Google</button>
<button class="accent" id="newBtn">æ–°å¢è¨‚å–®</button>
<button id="newExpenseBtn">æ–°å¢èŠ±è²»</button>
<button id="exportJson">åŒ¯å‡ºJSON</button>
<button id="exportXlsx">åŒ¯å‡ºExcel</button>
<button class="warn" id="importJson">åŒ¯å…¥JSON</button>
<button class="danger" id="clearAll">æ¸…ç©ºè³‡æ–™</button></div>
</div>
</header>
<main class="wrap stack" style="margin-top:16px">
<!-- è¨‚å–®åˆ—è¡¨ï¼ˆä¸Šï¼‰ -->
<section class="card">
<h2>è¨‚å–®åˆ—è¡¨</h2>
<div class="body">
<div class="sum" id="summary"></div>
<div class="hr"></div>
<div class="small muted"><details class="yearly-stats" id="ys-accordion"><summary class="ys-summary"><span aria-hidden="true" class="ys-chevron">â–¸</span><span class="ys-title">æŸ¥çœ‹å¹´åº¦è³‡æ–™</span></summary><div class="ys-content"><h2>æŸ¥çœ‹å¹´åº¦è³‡æ–™</h2><div class="ys-controls"><label>å¹´ä»½ï¼š<select id="yearSelect"></select></label><button id="recalc">è¨ˆç®—</button></div><div class="ys-cards"><div class="ys-card"><div class="ys-card-title">å¹´åº¦è¨‚å–®æ•¸</div><div class="ys-card-value" id="mOrders">--</div></div><div class="ys-card"><div class="ys-card-title">å¹´åº¦ç¸½é‡‘é¡</div><div class="ys-card-value" id="mGross">--</div></div><div class="ys-card"><div class="ys-card-title">å¹´åº¦æŠ˜å¾Œç¸½é‡‘é¡</div><div class="ys-card-value" id="mDiscounted">--</div></div><div class="ys-card"><div class="ys-card-title">å¹´åº¦èŠ±è²»</div><div class="ys-card-value" id="mCost">--</div></div><div class="ys-card"><div class="ys-card-title">å¹´åº¦æ·¨æ”¶å…¥</div><div class="ys-card-value" id="mNet">--</div></div></div><details><summary>å¦‚ä½•æä¾›è³‡æ–™ï¼Ÿ</summary><p>åœ¨ä»»ä¸€ script ä¸­è³¦å€¼ window.orders = [...]ï¼šæ¯ç­†éœ€å« date(YYYY-MM-DD)ã€amount(åŸåƒ¹)ã€discounted(æŠ˜å¾Œåƒ¹ï¼Œå¯ç„¡å‰‡è¦–ç‚º amount)ã€cost(æˆæœ¬/èŠ±è²»ï¼Œå¯ç„¡å‰‡è¦–ç‚º 0)ã€‚</p><pre>window.orders = [
  { date: "2025-01-05", amount: 1200, discounted: 1100, cost: 400 },
  { date: "2025-03-22", amount: 900, discounted: 900, cost: 200 },
];</pre></details><style>
/* Accordion Summary */
.yearly-stats { border: 1px solid #eee; border-radius: 12px; overflow: clip; }
.yearly-stats > .ys-summary {
  display:flex; align-items:center; gap:8px; padding:10px 12px;
  font-weight:600; cursor:pointer; user-select:none;
  background: linear-gradient(180deg, #fafafa, #f3f3f3);
}
.yearly-stats[open] > .ys-summary { background: #f9fafb; border-bottom:1px solid #eee; }
.ys-chevron { display:inline-block; transition: transform .2s ease; }
.yearly-stats[open] > .ys-summary .ys-chevron { transform: rotate(90deg); }
.ys-content { padding: 12px; }

/* Controls & Cards */
.ys-controls { display:flex; align-items:center; gap: 12px; margin: 8px 0 16px; flex-wrap: wrap; }
.ys-cards { display:grid; grid-template-columns: repeat(auto-fit,minmax(160px,1fr)); gap: 12px; }
.ys-card { padding: 12px; border: 1px solid #eee; border-radius: 12px; background:#fff; }
.ys-card-title { font-size: 12px; opacity: 0.7; }
.ys-card-value { font-size: 20px; font-weight: 700; }

/* Pretty button */
#recalc {
  appearance: none;
  padding: 8px 14px;
  border-radius: 9999px;
  border: 1px solid rgba(0,0,0,.08);
  background: linear-gradient(180deg, #4f8cff, #2f6bff);
  color: #fff;
  font-weight: 600;
  box-shadow: 0 6px 16px rgba(47,107,255,.25), 0 1px 0 rgba(255,255,255,.2) inset;
  transition: transform .06s ease, box-shadow .2s ease, filter .2s ease;
}
#recalc:hover { filter: brightness(1.05); box-shadow: 0 8px 20px rgba(47,107,255,.3), 0 1px 0 rgba(255,255,255,.25) inset; }
#recalc:active { transform: translateY(1px); }
#recalc:focus { outline: 2px solid #8ab4ff; outline-offset: 2px; }

/* Reduce motion */
@media (prefers-reduced-motion: reduce) {
  .ys-chevron { transition: none; }
  #recalc { transition: none; }
}

#yearSelect {
  font-size: 16px;
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: #fff;
  font-weight: 600;
  color: #333;
}
</style><script>
(function(){
  function currency(n){ if(isNaN(n)) return "--"; return n.toLocaleString(undefined,{minimumFractionDigits:0}); }
  function getYears(orders){
    const set = new Set();
    orders.forEach(o=>{
      const y = (o.date||"").slice(0,4);
      if(/^[0-9]{4}$/.test(y)) set.add(y);
    });
    if(set.size===0){ set.add(String(new Date().getFullYear())); }
    return Array.from(set).sort();
  }
  function calc(year){
    const orders = (window.orders||[]).filter(o=> (o.date||"").startsWith(String(year)));
    const count = orders.length;
    let gross=0, discounted=0, cost=0;
    orders.forEach(o=>{
      const a = Number(o.amount)||0;
      const d = (o.discounted==null? a : Number(o.discounted)||0);
      const c = Number(o.cost)||0;
      gross += a; discounted += d; cost += c;
    });
    const net = discounted - cost;
    document.getElementById('mOrders').textContent = currency(count);
    document.getElementById('mGross').textContent = currency(gross);
    document.getElementById('mDiscounted').textContent = currency(discounted);
    document.getElementById('mCost').textContent = currency(cost);
    document.getElementById('mNet').textContent = currency(net);
  }
  function init(){
    const orders = (window.orders||[]);
    const years = getYears(orders);
    const sel = document.getElementById('yearSelect');
    sel.innerHTML = "";
    years.forEach(y=>{
      const opt = document.createElement('option');
      opt.value = y; opt.textContent = y;
      sel.appendChild(opt);
    });
    const nowY = String(new Date().getFullYear());
    if(years.includes(nowY)) sel.value = nowY;
    calc(sel.value);
    document.getElementById('recalc').addEventListener('click', ()=> calc(sel.value));
    sel.addEventListener('change', ()=> calc(sel.value));
    // Recalculate if someone updates window.orders later
    const iv = setInterval(()=>{
      if(window.__orders_len !== (window.orders||[]).length){
        window.__orders_len = (window.orders||[]).length;
        // Rebuild years & recalc
        const ys = getYears(window.orders||[]);
        const same = ys.length===sel.options.length && Array.from(sel.options).every((o,i)=>o.value===ys[i]);
        if(!same){
          sel.innerHTML=""; ys.forEach(y=>{ const opt=document.createElement('option'); opt.value=y; opt.textContent=y; sel.appendChild(opt); });
        }
        if(sel.value && ys.includes(sel.value)) calc(sel.value); else { sel.value = ys[ys.length-1]; calc(sel.value); }
      }
    }, 1500);
  }
  if(document.readyState!=='loading') init(); else document.addEventListener('DOMContentLoaded', init);
})();
</script></div></details></div>
<div style="overflow:auto;margin-top:8px">
<!-- å¿«åˆ°æœŸæé†’å€å¡Š -->
<div class="card due-panel" id="dueSoonPanel">
<div class="card-title">å¿«åˆ°æœŸæé†’ï¼ˆ30 å¤©å…§ï¼‰</div>
<div class="due-list empty" id="dueSoonList">ç›®å‰æ²’æœ‰ 30 å¤©å…§å°‡åˆ°æœŸçš„å®¢æˆ¶</div>
</div>
<table id="ordersTable">
<thead>
<tr>
<th>#</th>
<th>æ—¥æœŸ</th>
<th>æ™‚é–“</th>
<th>ä½œæ¥­äººå“¡</th>
<th>å®¢æˆ¶</th>
<th>é›»è©±</th>
<th class="col-slot">æ™‚æ®µ</th>
<th>åœ°å€</th>
<th class="col-status">ç‹€æ³</th>
<th>ç¢ºèª</th>
<th>å ±åƒ¹å–®</th>
<th class="right-align col-total">ç¸½é‡‘é¡</th>
<th class="right-align">æŠ˜å¾Œ</th>
<th>ä¾†æº</th>
<th>æ“ä½œ</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>
</section>
<!-- è¨‚å–®è¡¨å–®ï¼ˆä¸­ï¼‰ -->
<details class="accordion" id="orderAccordion"><summary><span id="formTitle">æ–°å¢ / ç·¨è¼¯è¨‚å–®</span></summary><div class="content">
<form id="orderForm">
<input id="id" type="hidden"/>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>ä½œæ¥­äººå“¡</label>
<div class="toolbar" style="gap:8px">
<select id="staff"><option value="é€å¤©å±‹"></option><option value="å¤§æ¨“(æœ‰é›»æ¢¯)"></option><option value="å¤§æ¨“(ç„¡é›»æ¢¯)"></option><option value="å…¶ä»–(å¯è‡ªè¡Œè¼¸å…¥)"></option></select>
<button class="inline-btn" id="addStaffBtn" type="button">æ–°å¢äººå“¡</button>
</div>
</div>
<div class="col" style="grid-column:span 3">
<label>æ—¥æœŸï¼ˆå¯ç•™ç©ºï¼Œä¹‹å¾Œå†å¡«ï¼‰</label>
<input id="date" type="date"/>
</div>
<div class="col" style="grid-column:span 3">
<label>æ™‚é–“</label>
<input id="time" type="time"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>å§“åï¼ˆæ”¯æ´é€šè¨ŠéŒ„ï¼‰</label>
<input id="customer" list="contactsDL" placeholder="å®¢æˆ¶å§“å" type="text"/>
<datalist id="contactsDL"></datalist>
<div class="tiny">é¸æ—¢æœ‰å®¢æˆ¶æœƒè‡ªå‹•å¸¶å‡ºé›»è©±/åœ°å€</div>
</div>
<div class="col" style="grid-column:span 3">
<label>LINE or Fackbook ID</label>
<input id="lineId" type="text"/>
</div>
<div class="col" style="grid-column:span 3">
<label>é›»è©±</label>
<input id="phone" placeholder="æ‰‹æ©Ÿï¼ˆå¯ç•™ç©ºï¼‰0912-345-678ï¼›æˆ–æ”¹å¡« LINE" type="text"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 5">
<label>å®‰æ’æ™‚æ®µï¼ˆå¯è¤‡é¸ï¼‰</label>
<div class="checkbox-group" id="slotGroup"></div>
<input class="hidden tiny" id="slotNote" placeholder="è«‹è¼¸å…¥æŒ‡å®šæ—¥æœŸï¼æ™‚æ®µï¼ˆå¦‚ 10/10 ä¸Šåˆ æˆ– 10/12 9:00â€“12:00ï¼‰" type="text"/>
</div>
<div class="col" style="grid-column:span 7">
<label>æ¸…æ´—åœ°å€</label>
<input id="address" placeholder="åœ°å€" type="text"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>å±…ä½åœ°å‹æ…‹</label>
<div class="toolbar" style="gap:8px">
<select id="residenceType">
<option value="">ï¼ˆæœªé¸æ“‡ï¼‰</option>
<option value="é€å¤©å±‹">é€å¤©å±‹</option>
<option value="å¤§æ¨“(æœ‰é›»æ¢¯)">å¤§æ¨“(æœ‰é›»æ¢¯)</option>
<option value="å¤§æ¨“(ç„¡é›»æ¢¯)">å¤§æ¨“(ç„¡é›»æ¢¯)</option>
<option value="å…¶ä»–">å…¶ä»–ï¼ˆå¯è‡ªè¡Œè¼¸å…¥ï¼‰</option>
</select>
<input class="hidden" id="residenceOther" placeholder="è«‹è¼¸å…¥å…¶ä»–å‹æ…‹" type="text"/>
</div>
</div>
<div class="col" style="grid-column:span 6">
<label>æ–¹ä¾¿è¯ç¹«æ™‚é–“ï¼ˆå¯è¤‡é¸ï¼‰</label>
<div class="checkbox-group" id="contactTimesGroup"></div>
<input class="hidden tiny" id="contactTimeNote" placeholder="è«‹è¼¸å…¥æŒ‡å®šæ™‚é–“ï¼ˆå¦‚ 9:00â€“12:00 æˆ– é€±ä¸‰æ™šä¸Šï¼‰" type="text"/>
</div>
</div>
<div class="row" id="reminderRow">
<div class="col" style="grid-column:span 6">
<div class="toolbar" id="reminderToolbar" style="gap:8px; align-items:center; flex-wrap:wrap">
<label class="pill"><input checked="" id="reminderEnabled" type="checkbox"/> <span>å•Ÿç”¨æé†’</span></label>
<label class="muted">æé†’é€±æœŸï¼ˆæœˆï¼‰</label>
<input class="tiny compact" id="reminderMonths" min="0" placeholder="ä¾‹å¦‚ 12" step="1" type="number" value="24"/>
<label class="muted">ä¸‹æ¬¡æé†’</label>
<input class="tiny" disabled="" id="nextReminder" type="text"/>
<label class="pill"><input id="reminderNotified" type="checkbox"/> <span>å·²é€šçŸ¥</span></label>
<label class="pill danger"><input id="reminderMuted" type="checkbox"/> <span>ä¸å†æé†’</span></label>
</div>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>å†·æ°£ä½æ–¼æ¨“å±¤ï¼ˆå¯è¤‡é¸ï¼‰</label>
<div class="checkbox-group" id="acFloors"></div>
<div class="hidden" id="acFloorAboveWrap"><input id="acFloorAbove" placeholder="è«‹è¼¸å…¥å¯¦éš›æ¨“å±¤ï¼ˆä¾‹ï¼š6Fã€7Fâ€¦ï¼‰" type="text"/></div>
</div>
<div class="col" style="grid-column:span 6">
<label>æ´—è¡£æ©Ÿä½æ–¼æ¨“å±¤ï¼ˆå¯è¤‡é¸ï¼‰</label>
<div class="checkbox-group" id="washerFloors"></div>
<div class="hidden" id="washerFloorAboveWrap"><input id="washerFloorAbove" placeholder="è«‹è¼¸å…¥å¯¦éš›æ¨“å±¤ï¼ˆä¾‹ï¼š6Fã€7Fâ€¦ï¼‰" type="text"/></div>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 8">
<label>èˆ‡æˆ‘å¸è¯ç¹«æ–¹å¼</label>
<div class="toolbar" style="gap:8px">
<select id="contactMethod"></select>
<button class="inline-btn" id="addContactMethod" type="button">æ–°å¢è¯ç¹«æ–¹å¼</button>
</div>
</div>
<div class="col" style="grid-column:span 4">
<label>ç‹€æ³</label>
<select id="status">
<option value="æ’å®š">æ’å®š</option>
<option value="å®Œæˆ">å®Œæˆ</option>
<option value="æœªå®Œæˆ">æœªå®Œæˆ</option>
</select>
</div>
</div>
<div class="hr"></div>
<h3 style="margin:0 0 8px">æ¸…æ´—é …ç›®èˆ‡åƒ¹æ ¼</h3>
<div class="row">
<div class="col" style="grid-column:span 6">
<label><b><span style="color:red;font-size:15px">åˆ†é›¢å¼å†·æ°£å®¤å…§æ©Ÿï¼ˆæ¯å°1800ï¼›æ»¿3å°æ¯å°1500ï¼‰</span></b></label>
<input id="acSplit" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label>åŠéš±å¼å†·æ°£ï¼ˆæ¯å°2800ï¼‰</label>
<input id="acDuct" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label><b><span style="color:red;font-size:15px">ç›´ç«‹å¼æ´—è¡£æ©Ÿï¼ˆæ¯å°2000ï¼›è‹¥åŒå–®å«å†·æ°£å®¤å…§æ©Ÿå‰‡æ¯å°1800ï¼‰</span></b></label>
<input id="washerTop" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label>æ°´å¡”ï¼ˆæ¯é¡†1000ï¼‰</label>
<input id="waterTank" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>è‡ªä¾†æ°´ç®¡ï¼ˆè‡ªè¨‚é‡‘é¡ï¼Œæœªç¨…ç¸½é¡ï¼‰</label>
<input id="pipesAmount" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label><b><span style="color:red;font-size:15px">é˜²éœ‰å™´åŠ‘ï¼ˆæ¯å°300ï¼›æ»¿5å°æ¯å°250ï¼‰</span></b></label>
<input id="antiMold" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>è‡­æ°§æ®ºèŒï¼ˆæ¯é–“200ï¼‰</label>
<input id="ozone" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label>è®Šå½¢é‡‘å‰›æ©Ÿå‹ï¼ˆæ¯å°åŠ 500ï¼‰</label>
<input id="transformerCount" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>åˆ†é›¢å¼å®¤å…§æ©Ÿé•·åº¦ &gt; 182cmï¼ˆæ¯å°åŠ 300ï¼‰</label>
<input id="longSplitCount" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label>ä¸€é«”å¼æ°´ç›¤ï¼ˆæ¯å°åŠ 500ï¼‰</label>
<input id="onePieceTray" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 12">
<label>å‚™è¨»</label>
<textarea id="note" placeholder="å…¶ä»–è£œå……äº‹é …"></textarea>
</div>
</div>
<div class="hr"></div>
<div class="row">
<div class="col" style="grid-column:span 4">
<label><input id="confirmed" type="checkbox"/> å®¢äººç¢ºèªå®‰æ’æ™‚é–“</label>
</div>
<div class="col" style="grid-column:span 4">
<label><input id="quotationOk" type="checkbox"/> å®¢äººç¢ºèªå ±åƒ¹å–®</label>
</div>
<div class="col right-align" style="grid-column:span 4">
<button class="inline-btn" id="recalc" type="button">é‡æ–°è¨ˆç®—é‡‘é¡</button>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 3">
<label>ç¸½é‡‘é¡ï¼ˆè‡ªå‹•ï¼‰</label>
<input id="total" readonly="" type="number"/>
</div>
<div class="col" style="grid-column:span 3">
<label>é¡å¤–åŠ åƒ¹ï¼ˆæ‰‹å‹•è¼¸å…¥ï¼‰</label>
<input id="extraCharge" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 3">
<label>æŠ˜æ‰£é‡‘é¡ï¼ˆå¯è¼¸å…¥ï¼‰</label>
<input id="discount" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 3">
<label>æŠ˜å¾Œç¸½é‡‘é¡ï¼ˆè‡ªå‹•ï¼‰</label>
<input id="netTotal" readonly="" type="number"/>
</div>
</div>
<div class="hr"></div>
<div class="toolbar">
<button class="primary" id="saveBtn" type="submit">å„²å­˜è¨‚å–®</button>
<button id="resetBtn" type="button">æ¸…ç©ºè¡¨å–®</button>
<button id="copyLastBtn" type="button">è¤‡è£½ä¸Šä¸€ç­†</button>
<button id="copyFromHistoryBtn" type="button">å¾å®¢æˆ¶èˆŠå–®å¸¶å…¥</button>
<div class="right">
<span class="lock-badge" id="lockInfo"></span>
<div style="display:inline-block; margin-right:8px;"><label style="margin-right:4px;">æ™‚é•·(åˆ†)</label><input id="durationMinutes" min="15" step="15" style="width:70px;" type="number" value="120"/></div><button class="btn" onclick="handleUploadWithAuth(gatherForm())">ğŸ“…</button><button class="warn" id="toggleLock" type="button">è§£é–é‡‘é¡ç·¨è¼¯</button>
<button class="danger" disabled="" id="deleteBtn" type="button">åˆªé™¤æ­¤è¨‚å–®</button>
</div>
</div>
</form>
</div></details>
<!-- æ”¯å‡ºæ¨¡çµ„ï¼ˆä¸‹ï¼‰ä»¥æ‰‹é¢¨ç´å‘ˆç¾ -->
<details =""="" class="accordion" id="expenseAcc">
<summary>æœ¬æœˆèŠ±è²»ï¼ˆå¯å±•é–‹/æ”¶åˆï¼‰</summary>
<div class="content">
<div class="two-col">
<section class="card" style="border:none;box-shadow:none">
<h2>æœ¬æœˆèŠ±è²»åˆ—è¡¨</h2>
<div class="body">
<div class="toolbar" style="margin-bottom:8px">
<button id="expExportCsv">åŒ¯å‡ºèŠ±è²»CSV</button>
<button id="expExportJson">åŒ¯å‡ºèŠ±è²»JSON</button>
<button class="warn" id="expImportJson">åŒ¯å…¥èŠ±è²»JSON</button>
<button class="danger" id="expClear">æ¸…ç©ºèŠ±è²»</button>
</div>
<div style="overflow:auto">
<table id="expenseTable">
<thead>
<tr>
<th>#</th>
<th>æ—¥æœŸ</th>
<th>é¡åˆ¥</th>
<th>èªªæ˜</th>
<th class="right-align">é‡‘é¡</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>
</section>
<aside class="card" style="border:none;box-shadow:none">
<h2>æ–°å¢ / ç·¨è¼¯èŠ±è²»</h2>
<div class="body">
<form id="expenseForm">
<input id="expId" type="hidden"/>
<div class="row">
<div class="col" style="grid-column:span 4">
<label>æ—¥æœŸ</label>
<input id="expDate" type="date"/>
</div><div class="col" style="grid-column:span 3"><label>å·¥ä½œæ™‚é•·ï¼ˆåˆ†é˜ï¼‰</label><input id="durationMinutes" min="15" step="15" type="number" value="120"/></div>
<div class="col" style="grid-column:span 4">
<label>é¡åˆ¥</label>
<div class="toolbar" style="gap:8px">
<select id="expCategory"></select>
<button class="inline-btn" id="addExpCat" type="button">æ–°å¢é¡åˆ¥</button>
</div>
</div>
<div class="col" style="grid-column:span 4">
<label>é‡‘é¡</label>
<input id="expAmount" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 12">
<label>èªªæ˜</label>
<input id="expNote" placeholder="ä¾‹å¦‚ï¼šææ–™ã€åŠ æ²¹ã€åœè»Šã€å·¥å…·ç¶­ä¿®â€¦" type="text"/>
</div>
</div>
<div class="toolbar">
<button class="primary" id="expSave" type="submit">å„²å­˜èŠ±è²»</button>
<button id="expReset" type="button">æ¸…ç©ºè¡¨å–®</button>
<div class="right">
<button class="danger" disabled="" id="expDelete" type="button">åˆªé™¤æ­¤ç­†èŠ±è²»</button>
</div>
</div>
</form>
</div>
</aside>
</div>
</div>
</details>
</main>
<input accept=".json" class="hidden" id="filePicker" type="file"/>
<input accept=".json" class="hidden" id="filePickerExp" type="file"/>
<template id="expRowTpl">
<tr>
<td class="small muted"></td>
<td></td><td></td><td></td><td class="right-align"></td>
</tr>
</template>
<script src="https://apis.google.com/js/api.js"></script>
<div>
<!-- âœ… è¼‰å…¥ Google OAuth SDK -->
<script async="" defer="" src="https://accounts.google.com/gsi/client"></script>
<!-- âœ… åŠ åœ¨ refreshTable çš„æ¯ç­†è¨‚å–®æ“ä½œæ¬„ä½ä¸­ -->
<!-- âœ… è¡¨å–®ä¸­æ–°å¢ï¼šå·¥ä½œæ™‚é•·æ¬„ä½ -->
<!-- âœ… gatherForm() ä¸­è£œä¸Š -->
</div>
<script defer="" src="app.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function(){
  var acc = document.getElementById('ys-accordion');
  var btn = document.getElementById('recalc');
  if (!acc || !btn) return;
  acc.addEventListener('toggle', function(){
    if (acc.open) { btn.click(); }
  });
});
</script></body>
</html>
<!-- åŠ å…¥ Google API SDK -->
<script async="" defer="" src="https://accounts.google.com/gsi/client"></script>
